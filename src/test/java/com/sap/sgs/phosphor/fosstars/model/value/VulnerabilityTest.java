package com.sap.sgs.phosphor.fosstars.model.value;

import static org.junit.Assert.assertEquals;

import com.sap.sgs.phosphor.fosstars.model.value.Vulnerability.Resolution;
import java.util.Collections;
import java.util.Date;
import java.util.Optional;
import org.junit.Test;

public class VulnerabilityTest {

  @Test(expected = IllegalArgumentException.class)
  public void confusingResolution() {
    new Vulnerability("CVE-1", "test", CVSS.v2(5.0), Collections.emptyList(),
        Resolution.UNPATCHED, new Date(1), new Date(2));
  }

  @Test(expected = IllegalArgumentException.class)
  public void confusingIntroducedDate() {
    new Vulnerability("CVE-1", "test", CVSS.v2(5.0), Collections.emptyList(),
        Resolution.UNPATCHED, new Date(2), new Date(1));
  }

  public void shoutConstructor() {
    Vulnerability vulnerability = new Vulnerability("CVE-2019-0001");
    assertEquals("CVE-2019-0001", vulnerability.id());
    assertEquals(Optional.empty(), vulnerability.description());
    assertEquals(CVSS.UNKNOWN, vulnerability.cvss());
    assertEquals(Collections.emptyList(), vulnerability.references());
    assertEquals(Resolution.UNKNOWN, vulnerability.resolution());
    assertEquals(Optional.empty(), vulnerability.introduced());
    assertEquals(Optional.empty(), vulnerability.fixed());
  }

}